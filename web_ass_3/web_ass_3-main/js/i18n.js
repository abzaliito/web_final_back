const translations = {
  ru: {
    home: "Главная",
    catalog: "Каталог",
    gallery: "Галерея",
    about: "О нас",
    contact: "Контакты",
    cart: "Корзина",
    checkout: "Оформить заказ",
    theme_toggle: "Сменить тему",
    language: "Язык",
    news_title: "Новости технологий",
    all_news: "Все новости",
    technology: "Технологии",
    gadgets: "Гаджеты",
    ai: "ИИ",
    greeting_title: "Персональное приветствие",
    enter_name: "Введите ваше имя",
    greet_me: "Поприветствовать меня",
    rate_products: "Оцените наши товары",
    rate_description: "Кликните на звезду, чтобы поставить оценку",
    interactive_features: "Интерактивные функции",
    time_display: "Текущее время",
    time_description: "Нажмите кнопку, чтобы увидеть текущее время",
    show_time: "Показать время",
    random_fact: "Случайный факт",
    fact_description: "Получите интересный факт о технологиях",
    get_fact: "Получить факт",
    search_realtime: "Поиск в реальном времени",
    search_live: "Живая фильтрация товаров",
    search_placeholder: "Введите название товара...",
    autocomplete: "Автодополнение поиска",
    autocomplete_desc: "Предложения при вводе",
    autocomplete_placeholder: "Начните вводить...",
    highlight: "Подсветка поиска",
    highlight_desc: "Выделение совпадений",
    highlight_placeholder: "Введите текст для поиска...",
    products_title: "Каталог товаров",
    filter: "Фильтрация",
    search_product: "Поиск товара",
    category: "Категория",
    price: "Цена",
    rating: "Рейтинг",
    reset_filters: "Сбросить фильтры",
    comparison: "Сравнение товаров",
    select_comparison: "Выберите товары для сравнения",
    compare: "Сравнить",
    sort_by: "Сортировать по",
    price_low_high: "Цена: низкая → высокая",
    price_high_low: "Цена: высокая → низкая",
    by_rating: "По рейтингу",
    by_name: "По названию",
    found_products: "Найдено товаров",
    products_not_found: "Товары не найдены",
    buy: "Купить",
    compare_products: "Сравнение товаров",
    characteristic: "Характеристика",
    gallery_title: "Галерея товаров",
    search_by_name: "Поиск по названию...",
    all_categories: "Все категории",
    smartphones: "Смартфоны",
    laptops: "Ноутбуки",
    accessories: "Аксессуары",
    tablets: "Планшеты",
    highlight_search: "Подсветка поиска",
    enter_text_highlight: "Введите текст для выделения...",
    images_not_found: "Изображения не найдены",
    about_title: "О нас",
    contact_title: "Контакты",
    cart_title: "Корзина",
    checkout_title: "Оформление заказа",
    achievements: "Наши достижения",
    happy_clients: "Довольных клиентов",
    products_catalog: "Товаров в каталоге",
    support: "Поддержка клиентов",
    faq: "Часто задаваемые вопросы",
    delivery_methods: "Какие способы доставки у вас есть?",
    delivery_answer:
      "Мы предлагаем несколько вариантов: курьерская доставка, самовывоз и экспресс-доставка. Заказы от 10 000 ₽ доставляются бесплатно.",
    return_policy: "Можно ли вернуть товар?",
    return_answer:
      "Да, вы можете вернуть товар в течение 14 дней с момента покупки, если он не был в использовании и сохранены все ярлыки и упаковка.",
    newsletter: "Подписка на новости",
    newsletter_desc: "Получайте скидки и первыми узнавайте о новинках.",
    subscribe: "Подписаться",
    name: "Имя",
    email: "Email",
    policy_agree: "Я согласен с политикой конфиденциальности.",
    subscription_success: "Вы успешно подписались на рассылку!",
    more: "Подробнее",
    team: "Команда: Nurkasym, Abzal, Mirzan, Abylaikhan",
  },
  en: {
    home: "Home",
    catalog: "Catalog",
    gallery: "Gallery",
    about: "About",
    contact: "Contact",
    cart: "Cart",
    checkout: "Checkout",
    theme_toggle: "Toggle Theme",
    language: "Language",
    news_title: "Tech News",
    all_news: "All News",
    technology: "Technology",
    gadgets: "Gadgets",
    ai: "AI",
    greeting_title: "Personal Greeting",
    enter_name: "Enter your name",
    greet_me: "Greet Me",
    rate_products: "Rate Our Products",
    rate_description: "Click on a star to rate",
    interactive_features: "Interactive Features",
    time_display: "Current Time",
    time_description: "Click the button to see current time",
    show_time: "Show Time",
    random_fact: "Random Fact",
    fact_description: "Get an interesting tech fact",
    get_fact: "Get Fact",
    search_realtime: "Real-time Search",
    search_live: "Live product filtering",
    search_placeholder: "Enter product name...",
    autocomplete: "Search Autocomplete",
    autocomplete_desc: "Suggestions while typing",
    autocomplete_placeholder: "Start typing...",
    highlight: "Search Highlighting",
    highlight_desc: "Highlight matches",
    highlight_placeholder: "Enter text to search...",
    products_title: "Product Catalog",
    filter: "Filters",
    search_product: "Search product",
    category: "Category",
    price: "Price",
    rating: "Rating",
    reset_filters: "Reset Filters",
    comparison: "Compare Products",
    select_comparison: "Select products to compare",
    compare: "Compare",
    sort_by: "Sort by",
    price_low_high: "Price: Low → High",
    price_high_low: "Price: High → Low",
    by_rating: "By Rating",
    by_name: "By Name",
    found_products: "Products found",
    products_not_found: "Products not found",
    buy: "Buy",
    compare_products: "Product Comparison",
    characteristic: "Characteristic",
    gallery_title: "Product Gallery",
    search_by_name: "Search by name...",
    all_categories: "All categories",
    smartphones: "Smartphones",
    laptops: "Laptops",
    accessories: "Accessories",
    tablets: "Tablets",
    highlight_search: "Highlight Search",
    enter_text_highlight: "Enter text to highlight...",
    images_not_found: "Images not found",
    about_title: "About Us",
    contact_title: "Contact Us",
    cart_title: "Shopping Cart",
    checkout_title: "Checkout",
    achievements: "Our Achievements",
    happy_clients: "Happy Clients",
    products_catalog: "Products in Catalog",
    support: "Customer Support",
    faq: "Frequently Asked Questions",
    delivery_methods: "What delivery methods are available?",
    delivery_answer:
      "We offer several options: courier delivery, pickup and express delivery. Orders from 10,000 ₽ are shipped free.",
    return_policy: "Can I return the product?",
    return_answer:
      "Yes, you can return the product within 14 days of purchase if it has not been used and all tags and packaging are preserved.",
    newsletter: "Newsletter Subscription",
    newsletter_desc:
      "Get discounts and be the first to know about new products.",
    subscribe: "Subscribe",
    name: "Name",
    email: "Email",
    policy_agree: "I agree with the privacy policy.",
    subscription_success: "You have successfully subscribed to the newsletter!",
    more: "Learn More",
    team: "Team: Nurkasym, Abzal, Mirzan, Abylaikhan",
  },
  kk: {
    home: "Басты бет",
    catalog: "Каталог",
    gallery: "Галерея",
    about: "Туралы",
    contact: "Байланыс",
    cart: "Себет",
    checkout: "Тапсыру",
    theme_toggle: "Тақырыпты ауыстыру",
    language: "Тіл",
    news_title: "Технология жаңалықтары",
    all_news: "Барлық жаңалықтар",
    technology: "Технология",
    gadgets: "Гаджеттер",
    ai: "АИ",
    greeting_title: "Жеке сәлеме",
    enter_name: "Өзіңіздің атыңызды енгізіңіз",
    greet_me: "Маған сәлем",
    rate_products: "Біздің өнімдерді бағалаңыз",
    rate_description: "Бағалау үшін жұлдызды басыңыз",
    interactive_features: "Интерактивті функциялар",
    time_display: "Ағымды уақыт",
    time_description: "Ағымды уақытты көру үшін батырманы басыңыз",
    show_time: "Уақытты көрсету",
    random_fact: "Кездейсоқ факт",
    fact_description: "Қызықты технология фактысын алыңыз",
    get_fact: "Факт алу",
    search_realtime: "Нақты уақыт іздеу",
    search_live: "Өнімдерді сүзгілеу",
    search_placeholder: "Өнімнің атын енгізіңіз...",
    autocomplete: "Іздеу автодополнение",
    autocomplete_desc: "Теру кезінде ұсыныстар",
    autocomplete_placeholder: "Теруді бастаңыз...",
    highlight: "Іздеу ішіндегі ерекшелеу",
    highlight_desc: "Сәйкестіктерді ерекшелеу",
    highlight_placeholder: "Іздеу үшін мәтін енгізіңіз...",
    products_title: "Өнім каталогы",
    filter: "Сүзгілеу",
    search_product: "Өнімді іздеу",
    category: "Санат",
    price: "Баға",
    rating: "Рейтинг",
    reset_filters: "Сүзгілерді тастау",
    comparison: "Өнімдерді салыстыру",
    select_comparison: "Салыстыру үшін өнімдерді таңдаңыз",
    compare: "Салыстыру",
    sort_by: "Сортау",
    price_low_high: "Баға: төмен → жоғары",
    price_high_low: "Баға: жоғары → төмен",
    by_rating: "Рейтингі бойынша",
    by_name: "Аты бойынша",
    found_products: "Табылды өнімдер",
    products_not_found: "Өнімдер табылмады",
    buy: "Сатып алу",
    compare_products: "Өнімдерді салыстыру",
    characteristic: "Сипаттамасы",
    gallery_title: "Өнім галереясы",
    search_by_name: "Атау бойынша іздеу...",
    all_categories: "Барлық санаттар",
    smartphones: "Смартфондар",
    laptops: "Ноутбуктар",
    accessories: "Аксессуарлар",
    tablets: "Планшеттер",
    highlight_search: "Іздеу ішіндегі ерекшелеу",
    enter_text_highlight: "Ерекшелеу үшін мәтін енгізіңіз...",
    images_not_found: "Суреттер табылмады",
    about_title: "Біз туралы",
    contact_title: "Байланыс",
    cart_title: "Сатып алу себеті",
    checkout_title: "Сатып алуды рәсімдеу",
    achievements: "Біздің жетістіктер",
    happy_clients: "Қанағаттанған клиенттер",
    products_catalog: "Каталогтағы өнімдер",
    support: "Клиент қолдауы",
    faq: "Жиі қойылатын сұрақтар",
    delivery_methods: "Қандай жеткізу әдістері бар?",
    delivery_answer:
      "Біз бірнеше нұсқа ұсынамыз: курьер жеткізуі, өз бетінше алуы және экспресс жеткізуі. 10 000 ₽ төл алиптерінен жүргілік ағымын тегіс.",
    return_policy: "Өнімді қайта бере аламын ба?",
    return_answer:
      "Иә, сатып алғаннан кейін 14 күн ішінде өнімді қайта бере аласыз, егер ол пайдаланылмаса және барлық белгілер мен орау сақталса.",
    newsletter: "Жаңалықтарға жазылу",
    newsletter_desc: "Скидкалар алыңыз және жаңалықтарды алғаш біліңіз.",
    subscribe: "Жазылу",
    name: "Атауы",
    email: "Электрондық пошта",
    policy_agree: "Құпиялылық саясатына келісемін.",
    subscription_success: "Сіз жаршысына сәтті жазылдыңыз!",
    more: "Толығырақ",
    team: "Команда: Nurkasym, Abzal, Mirzan, Abylaikhan",
  },
};

class I18n {
  constructor() {
    this.currentLanguage = localStorage.getItem("language") || "ru";
    this.currentTheme = localStorage.getItem("theme") || "light";
    this.init();
  }

  init() {
    this.applyLanguage(this.currentLanguage);
    this.applyTheme(this.currentTheme);
    this.setupListeners();
  }

  setupListeners() {
    document.addEventListener("click", (e) => {
      if (e.target.matches("[data-lang]")) {
        this.setLanguage(e.target.dataset.lang);
      }
      if (e.target.matches("[data-theme-toggle]")) {
        this.toggleTheme();
      }
    });
  }

  setLanguage(lang) {
    this.currentLanguage = lang;
    localStorage.setItem("language", lang);
    this.applyLanguage(lang);
    this.updateLanguageButtons();
  }

  applyLanguage(lang) {
    document.documentElement.lang = lang;
    document.querySelectorAll("[data-translate]").forEach((el) => {
      const key = el.dataset.translate;
      if (translations[lang][key]) {
        if (
          (el.tagName === "INPUT" || el.tagName === "TEXTAREA") &&
          (el.type === "text" || el.type === "email")
        ) {
          el.placeholder = translations[lang][key];
        } else if (el.tagName === "SELECT") {
          el.querySelectorAll("option").forEach((opt) => {
            const optKey = opt.dataset.translate;
            if (optKey && translations[lang][optKey]) {
              opt.textContent = translations[lang][optKey];
            }
          });
        } else {
          el.textContent = translations[lang][key];
        }
      }
    });

    document.querySelectorAll("[data-translate-placeholder]").forEach((el) => {
      const key = el.dataset.translatePlaceholder;
      if (translations[lang][key]) {
        el.placeholder = translations[lang][key];
      }
    });
  }

  toggleTheme() {
    const newTheme = this.currentTheme === "light" ? "dark" : "light";
    this.setTheme(newTheme);
  }

  setTheme(theme) {
    this.currentTheme = theme;
    localStorage.setItem("theme", theme);
    this.applyTheme(theme);
  }

  applyTheme(theme) {
    document.documentElement.setAttribute("data-bs-theme", theme);
    document.body.classList.remove("bg-body-tertiary", "bg-dark");

    if (theme === "dark") {
      document.body.classList.add("bg-dark", "text-white");
    } else {
      document.body.classList.add("bg-body-tertiary");
    }

    this.updateThemeButton();
  }

  updateThemeButton() {
    const btn = document.querySelector("[data-theme-toggle]");
    if (btn) {
      const icon = btn.querySelector("i");
      if (this.currentTheme === "dark") {
        icon.classList.remove("bi-palette-fill");
        icon.classList.add("bi-sun-fill");
        btn.title = "Светлая тема";
      } else {
        icon.classList.remove("bi-sun-fill");
        icon.classList.add("bi-palette-fill");
        btn.title = "Тёмная тема";
      }
    }
  }

  updateLanguageButtons() {
    document.querySelectorAll("[data-lang]").forEach((btn) => {
      btn.classList.toggle("active", btn.dataset.lang === this.currentLanguage);
    });
  }

  t(key) {
    return translations[this.currentLanguage][key] || key;
  }
}

const i18n = new I18n();
